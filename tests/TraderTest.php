<?php

use LupeCode\phpTraderNative\Trader;

require_once __DIR__ . '/../source/Trader.php';

class TraderTest extends PHPUnit_Framework_TestCase
{

    protected $Open   =
        [
            '37.56', '36.89', '36.25', '35.58', '35.87', '36.40', '37.64', '37.37', '37.37', '37.27', '37.43', '37.39',
            '37.43', '36.63', '36.70', '36.97', '36.82', '36.84', '36.90', '36.67', '37.11', '36.66', '37.25', '37.73',
            '36.88', '36.13', '36.63', '36.85', '36.46', '36.05', '36.94', '37.09', '37.44', '37.03', '36.91', '37.39',
            '37.28', '37.17', '36.97', '36.55', '37.06', '35.81', '36.25', '36.65', '36.51', '36.84', '37.52', '37.32',
            '37.47', '37.50', '37.92', '37.10', '36.46', '36.24', '37.13', '37.47', '36.94', '36.65', '36.38', '36.85',
            '35.86', '36.40', '36.70', '36.55', '36.54', '36.51', '36.61', '35.05', '35.39', '34.45', '35.43', '34.68',
            '35.00', '34.54', '33.88', '33.03', '33.32', '33.75', '33.29', '33.59', '33.09', '33.66', '33.68', '32.91',
            '32.71', '32.81', '32.04', '31.31', '31.68', '30.74', '30.41', '31.20', '30.65', '30.19', '29.56', '29.47',
            '27.98', '27.12', '26.46', '27.11', '26.64', '27.61', '29.06', '27.91', '28.45', '29.32', '29.27', '29.10',
            '30.59', '29.90', '29.76', '29.96', '29.97', '28.75', '28.98', '29.84', '29.28', '29.69', '30.89', '30.58',
            '30.65', '30.51', '30.97', '31.67', '31.55', '32.12', '33.22', '33.85', '33.63', '33.90', '34.19', '34.24',
            '32.99', '33.12', '33.10', '33.81', '33.15', '32.53', '32.94', '34.01', '34.49', '35.80', '34.24', '34.76',
            '34.34', '35.59', '35.00', '33.87', '33.03', '32.79', '32.77', '33.09', '33.00', '32.86', '33.21', '32.89',
            '33.01', '32.23', '32.78', '33.20', '34.21', '33.45', '34.07', '34.94', '35.02', '34.89', '35.15', '35.46',
            '35.14', '34.87', '34.30', '34.97', '33.13', '32.65', '31.26', '32.06', '33.49', '33.26', '33.64', '32.42',
            '32.28', '32.56', '32.71', '32.35', '31.79', '31.31', '30.79', '30.80', '28.62', '28.95', '28.65', '28.58',
            '29.03', '29.66', '29.47', '30.56', '30.78', '31.20', '30.51', '31.31', '31.14', '29.72', '30.68', '31.09',
            '31.35', '30.40', '32.20', '32.00', '31.86', '32.01', '31.49', '32.91', '33.32', '33.36', '32.46', '32.98',
            '29.02', '33.58', '34.77', '35.67', '35.78', '36.24', '35.82', '35.08', '34.29', '36.74', '36.87', '36.52',
            '37.34', '37.32', '36.61', '36.67', '37.56', '37.50', '37.92', '37.64', '38.31', '39.58', '39.30', '38.57',
            '39.61', '39.98', '39.19', '38.70', '38.51', '38.65', '38.25', '38.35', '38.23', '37.20', '38.24', '38.76',
            '39.26', '39.46',
        ];
    protected $High   =
        [
            '38.08', '37.58', '37.08', '36.14', '36.01', '36.95', '37.78', '37.52', '37.55', '37.68', '37.44', '37.45',
            '37.60', '37.44', '36.91', '37.14', '37.73', '37.30', '36.99', '37.20', '37.11', '37.22', '37.74', '38.08',
            '37.88', '36.85', '36.96', '37.63', '36.95', '36.72', '37.23', '37.50', '37.70', '37.79', '37.07', '37.51',
            '37.63', '37.58', '37.35', '37.31', '37.45', '36.09', '36.41', '36.74', '36.98', '37.44', '37.59', '37.54',
            '37.54', '38.09', '38.12', '38.19', '36.73', '37.00', '37.15', '37.50', '37.35', '36.83', '36.85', '36.92',
            '37.25', '37.00', '36.92', '37.50', '36.88', '37.02', '37.28', '36.43', '35.45', '34.87', '35.70', '35.61',
            '36.10', '35.21', '34.55', '34.08', '33.46', '34.09', '33.86', '33.60', '33.52', '33.82', '34.38', '33.93',
            '33.21', '33.24', '32.85', '32.46', '31.90', '31.36', '31.12', '31.38', '31.21', '30.23', '30.14', '29.66',
            '29.44', '27.32', '26.97', '27.81', '27.69', '27.97', '29.14', '29.23', '28.61', '30.23', '29.79', '29.51',
            '30.63', '30.53', '30.19', '30.39', '30.52', '29.80', '29.11', '30.00', '29.77', '30.57', '31.17', '30.97',
            '30.75', '31.54', '31.19', '32.46', '32.33', '32.35', '33.69', '34.04', '34.17', '33.91', '34.74', '34.58',
            '34.21', '33.30', '33.63', '34.08', '33.88', '33.39', '33.27', '34.15', '34.73', '35.84', '34.98', '34.92',
            '35.20', '35.72', '36.39', '33.89', '33.83', '33.09', '33.52', '33.19', '33.87', '33.30', '33.50', '33.02',
            '33.12', '32.99', '33.04', '33.85', '34.23', '34.13', '34.08', '35.20', '35.30', '35.24', '35.34', '35.48',
            '35.70', '35.15', '35.27', '35.47', '33.49', '33.36', '31.90', '32.43', '33.59', '33.63', '33.86', '33.49',
            '32.49', '32.83', '33.02', '32.69', '32.50', '31.99', '31.19', '31.20', '30.71', '29.00', '29.11', '29.23',
            '29.22', '29.71', '29.57', '30.57', '30.92', '31.74', '30.80', '31.33', '31.77', '31.23', '30.92', '31.43',
            '31.59', '31.80', '32.83', '32.29', '32.74', '32.03', '32.10', '32.99', '33.57', '33.77', '32.62', '33.03',
            '32.28', '34.02', '34.95', '35.67', '36.19', '36.24', '36.35', '36.61', '34.77', '36.77', '37.69', '36.76',
            '37.52', '37.71', '37.21', '36.98', '37.57', '37.69', '37.92', '37.92', '38.31', '39.58', '39.78', '39.63',
            '39.85', '39.98', '39.79', '38.96', '38.80', '39.03', '38.80', '38.42', '38.68', '37.49', '38.38', '39.12',
            '39.64', '39.78',
        ];
    protected $Low    =
        [
            '37.43', '36.89', '36.25', '35.50', '35.05', '36.09', '37.41', '37.17', '37.20', '37.24', '36.81', '36.54',
            '37.10', '36.63', '36.42', '36.59', '36.71', '36.84', '36.63', '36.52', '36.50', '36.58', '36.56', '37.50',
            '36.84', '36.07', '35.47', '36.77', '36.43', '35.88', '36.67', '36.89', '37.25', '36.88', '36.38', '36.79',
            '37.20', '37.14', '36.92', '36.49', '36.86', '35.74', '35.91', '36.32', '36.15', '36.51', '36.63', '36.91',
            '37.18', '37.16', '37.35', '37.00', '36.11', '35.88', '36.42', '36.85', '36.90', '36.28', '36.32', '35.62',
            '35.72', '36.31', '36.22', '36.54', '36.31', '36.50', '36.44', '35.01', '34.62', '33.93', '34.71', '34.68',
            '35.00', '34.38', '33.87', '33.00', '33.11', '33.51', '32.84', '32.09', '32.78', '32.84', '33.59', '32.76',
            '32.42', '32.77', '32.04', '31.31', '31.22', '30.24', '29.80', '30.51', '30.39', '29.70', '29.39', '29.06',
            '27.94', '26.72', '26.15', '26.84', '26.51', '26.48', '27.73', '27.71', '26.57', '28.13', '28.79', '28.51',
            '28.60', '29.45', '29.62', '29.66', '29.31', '28.19', '27.44', '29.31', '28.59', '28.71', '29.33', '30.21',
            '29.74', '30.00', '30.02', '31.60', '31.53', '31.14', '33.18', '33.35', '33.60', '33.35', '34.10', '33.99',
            '32.97', '32.69', '32.87', '33.11', '32.91', '32.50', '32.21', '32.82', '33.91', '33.15', '34.03', '34.47',
            '34.18', '34.10', '34.77', '33.47', '32.85', '32.44', '32.75', '32.61', '32.87', '32.69', '32.58', '32.32',
            '32.62', '32.12', '32.17', '33.13', '33.03', '33.26', '33.08', '33.46', '34.16', '34.75', '34.65', '35.07',
            '35.05', '34.70', '34.30', '33.88', '33.00', '32.24', '31.21', '31.01', '32.77', '33.18', '33.16', '32.40',
            '31.77', '32.32', '32.55', '31.99', '31.73', '31.21', '30.66', '30.35', '28.43', '28.44', '28.49', '27.85',
            '27.20', '28.91', '28.85', '29.63', '30.17', '30.88', '30.41', '30.81', '30.99', '29.41', '30.00', '30.63',
            '31.03', '30.35', '30.86', '31.44', '31.80', '31.38', '31.23', '32.23', '32.93', '32.95', '31.11', '31.54',
            '29.00', '32.91', '33.87', '35.03', '35.60', '35.77', '35.72', '34.82', '33.85', '35.73', '36.87', '36.15',
            '36.30', '37.23', '36.60', '36.37', '36.62', '37.30', '37.38', '37.27', '37.65', '38.67', '39.06', '38.26',
            '39.35', '39.26', '38.93', '38.60', '38.15', '38.44', '38.10', '37.78', '37.52', '36.94', '36.58', '38.46',
            '39.19', '39.15',
        ];
    protected $Close  =
        [
            '37.99', '37.56', '36.86', '36.04', '35.22', '36.24', '37.78', '37.36', '37.40', '37.29', '36.94', '37.39',
            '37.32', '37.40', '36.47', '36.83', '37.35', '36.97', '36.73', '37.07', '36.60', '37.15', '36.65', '37.94',
            '37.82', '36.76', '35.59', '37.53', '36.66', '36.50', '37.02', '37.24', '37.27', '37.48', '36.48', '37.03',
            '37.37', '37.44', '37.18', '37.23', '36.94', '36.00', '36.01', '36.53', '36.60', '36.59', '36.95', '37.11',
            '37.23', '37.48', '37.67', '37.84', '36.33', '36.52', '36.51', '37.17', '37.31', '36.66', '36.48', '36.07',
            '36.17', '36.66', '36.41', '37.02', '36.48', '36.81', '36.56', '36.32', '35.23', '34.86', '34.80', '35.41',
            '35.47', '35.17', '34.28', '34.01', '33.26', '33.58', '33.81', '32.82', '33.51', '32.93', '33.96', '33.86',
            '32.88', '32.91', '32.80', '31.79', '31.37', '31.36', '30.95', '30.67', '31.17', '30.04', '29.42', '29.37',
            '29.28', '27.04', '26.76', '27.10', '26.82', '27.05', '27.97', '29.15', '27.68', '29.06', '29.57', '29.51',
            '28.75', '29.69', '29.98', '29.78', '29.75', '29.31', '28.78', '29.74', '29.14', '30.32', '29.44', '30.69',
            '30.17', '30.63', '30.16', '32.16', '32.20', '31.40', '33.26', '33.37', '34.04', '33.60', '34.11', '34.45',
            '34.19', '32.97', '32.95', '33.23', '33.78', '33.03', '32.59', '32.91', '34.63', '34.40', '34.85', '34.68',
            '34.91', '34.34', '35.65', '33.71', '33.81', '32.94', '33.16', '32.96', '33.36', '33.11', '32.63', '32.98',
            '32.86', '32.95', '32.19', '33.23', '33.38', '33.99', '33.68', '34.20', '35.12', '35.07', '34.72', '35.27',
            '35.62', '35.05', '35.19', '34.30', '33.40', '33.17', '31.67', '31.12', '32.83', '33.50', '33.37', '33.48',
            '32.09', '32.34', '32.86', '32.52', '32.37', '31.87', '30.96', '30.85', '30.71', '28.91', '28.91', '28.26',
            '27.60', '29.13', '29.34', '29.74', '30.40', '31.17', '30.74', '30.93', '31.40', '31.04', '30.32', '31.43',
            '31.15', '31.52', '30.90', '31.58', '32.54', '31.77', '31.60', '32.24', '33.14', '33.69', '32.52', '31.74',
            '31.31', '32.93', '34.10', '35.19', '35.69', '36.10', '36.24', '35.93', '34.49', '36.03', '37.15', '36.67',
            '36.46', '37.25', '37.12', '36.69', '36.67', '37.42', '37.67', '37.72', '37.84', '38.85', '39.21', '39.24',
            '39.73', '39.54', '39.68', '38.91', '38.38', '38.63', '38.76', '37.92', '37.61', '37.23', '38.23', '38.61',
            '39.38', '39.33',
        ];
    protected $Volume =
        [
            '10602800', '15209900', '10808200', '10990700', '14108600', '19657800', '07710900', '06279200', '05574600',
            '08957300', '12593900', '10634000', '10213200', '13023100', '06519800', '11216500', '14759100', '09181900',
            '14757100', '08426100', '12059100', '12179300', '22177600', '12873600', '14645900', '16285700', '33984900',
            '10623800', '07785800', '34330700', '07127500', '08497900', '11340300', '16995100', '11073200', '11170900',
            '10010800', '07178500', '06157400', '09218200', '13718900', '09668700', '09088800', '06585500', '12006800',
            '13175900', '16401800', '10083100', '09832100', '09106700', '11658700', '30761900', '20460600', '17738300',
            '19046900', '16620000', '17166400', '10447800', '13750800', '20273400', '38789100', '19445000', '12443000',
            '20227300', '13656200', '18679000', '19849800', '23603400', '12981000', '14118600', '12217700', '11613900',
            '13551300', '20552600', '09335700', '11002500', '10672300', '08252700', '12380800', '19452000', '12653200',
            '21043800', '22924000', '22946600', '11361400', '10462200', '14850900', '21168500', '16683500', '19907400',
            '12613500', '17072300', '21465100', '20735000', '15319400', '12949700', '20187900', '13011900', '11188200',
            '09098800', '14324800', '24498200', '16379600', '28548200', '55707000', '36544700', '12905700', '18979500',
            '15589300', '13534600', '11426200', '23176900', '16298100', '16282500', '20458900', '20053000', '17572600',
            '15031400', '16692400', '13198500', '17140100', '26322800', '21209100', '16047800', '14301100', '25194400',
            '07423300', '05933500', '12621900', '11020800', '03470700', '13469200', '15531300', '09106700', '16921800',
            '13243500', '12689400', '16140900', '15949600', '14936200', '16174200', '45101900', '19852600', '12047900',
            '16109600', '17080500', '56708100', '11020400', '17534700', '05316100', '13257200', '13364700', '11899700',
            '12498500', '14222100', '11105600', '10270400', '11087800', '11063300', '14273100', '11804100', '11511000',
            '13645500', '16608600', '15679100', '17501800', '12394300', '15206700', '17418900', '10796200', '15174300',
            '26380900', '15810300', '24308600', '18501200', '30390400', '19349200', '10856500', '12209300', '19403800',
            '11282800', '15873800', '12580300', '11830400', '14245400', '12224800', '10963900', '12883300', '29250500',
            '14467600', '18317900', '41895400', '49541300', '12817500', '19109900', '12755400', '15614900', '18745000',
            '20538300', '17094200', '22179700', '25661600', '22186900', '14365400', '14330900', '47058500', '26873900',
            '13854100', '13748900', '15688100', '19903500', '13609000', '09366100', '19105100', '25414500', '15752300',
            '23163400', '18373600', '15604400', '08976700', '11445300', '07933600', '12241100', '28987700', '31405700',
            '13833200', '11351400', '11845500', '12299700', '06844000', '09051900', '09887300', '15446100', '09542700',
            '10290600', '10333100', '12942700', '08590700', '09267400', '17714800', '14861600', '14752100', '14864300',
            '08462400', '09147300', '09506500', '08713200', '10057600', '16909400', '20529200', '19432500', '11803400',
            '07713000', '06398400',
        ];

    public function testInterfaceFunctions_acos()
    {
        $Expected = trader_acos(array_map('cos', $this->Close));
        $Trader = new Trader();
        $Actual   = $Trader->acos(array_map('cos', $this->Close));
        $Expected = array_map('round', $Expected, array_pad([], count($Expected), 3));
        $Actual   = array_map('round', $Actual, array_pad([], count($Actual), 3));
        $this->assertEquals($Expected, $Actual);
    }

    public function testInterfaceFunctions_ad()
    {
        $Expected = trader_ad($this->High, $this->Low, $this->Close, $this->Volume);
        $Trader = new Trader();
        $Actual   = $Trader->ad($this->High, $this->Low, $this->Close, $this->Volume);
        $Expected = array_map('round', $Expected, array_pad([], count($Expected), 3));
        $Actual   = array_map('round', $Actual, array_pad([], count($Actual), 3));
        $this->assertEquals($Expected, $Actual);
    }

    public function testInterfaceFunctions_add()
    {
        $Trader = new Trader();
        $this->assertEquals(trader_add($this->High, $this->Low), $Trader->add($this->High, $this->Low));
    }

    public function testInterfaceFunctions_adosc()
    {
        $Expected = trader_adosc($this->High, $this->Low, $this->Close, $this->Volume, 3, 10);
        $Trader = new Trader();
        $Actual = $Trader->adosc($this->High, $this->Low, $this->Close, $this->Volume, 3, 10);
        $Expected = array_map('round', $Expected, array_pad([], count($Expected), 3));
        $Actual   = array_map('round', $Actual, array_pad([], count($Actual), 3));
        $this->assertEquals($Expected, $Actual);
    }

}
